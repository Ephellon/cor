<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="assets/style.css">
        <link rel="stylesheet" type="text/css" href="assets/highlightjs/cor.css">
        <link rel="shortcut icon" href="assets/favicon.ico" />
        <title>Cor - Documentation</title>
    </head>
    <body>
    <span id="top"></span>
    
    <div class="goto-top"><a href="#top">^</a></div>

    <nav class="navbar" role="navigation">
        <div class="nav content">
            <ul class="left">
				<li class="inline"><a href="../index.html">Cor</a></li>
                <li class="inline"><a href="get_started.html">Get started</a></li>
                <li class="inline"><a href="documentation.html">Documentation</a></li>
                <li class="inline"><a href="playground/index.html">Playground</a></li>
                <li class="inline"><a href="../test/index.html">Run tests</a></li>
            </ul>
			<ul class="right">
                <li class="inline"><a class="icon-twitter" href="http://twitter.com/yosbelms" target="_blank"></a></li>
                <li class="inline"><a class="icon-github" href="https://github.com/yosbelms/cor" target="_blank"></a></li>
            </ul>
        </div>
    </nav>

    <div class="body content">

<h1 id="documentation">Documentation</h1>

<p>This is a reference manual for the Cor programming language. It will guide you inside language aspects and concepts, including experimental features to be added in future releases. Cor is a language designed with large web development in mind. Hence, is possible to develop your software without to execute any command to compile the source code, CLI tools are only needed to make the product able for production environments.</p>

<p><h2>Table of Content</h2><a class="toclink toclink-2" href="#quickrecap">Quick recap</a><a class="toclink toclink-3" href="#inlcudingmodules">Inlcuding modules</a><a class="toclink toclink-3" href="#functions">Functions</a><a class="toclink toclink-3" href="#slicescoalesceoperatorconditionaloperator">Slices/CoalesceOperator/ConditionalOperator</a><a class="toclink toclink-3" href="#classes">Classes</a><a class="toclink toclink-3" href="#inheritance">Inheritance</a><a class="toclink toclink-3" href="#instances">Instances</a><a class="toclink toclink-3" href="#ifforswitch">If/For/Switch</a><a class="toclink toclink-3" href="#typeassertionerrors">TypeAssertion/Errors</a><a class="toclink toclink-2" href="#semicoloninsertion">Semicolon Insertion</a><a class="toclink toclink-2" href="#expressions">Expressions</a><a class="toclink toclink-3" href="#comments">Comments</a><a class="toclink toclink-3" href="#variablesandlexicalscoping">Variables and Lexical Scoping</a><a class="toclink toclink-3" href="#objects">Objects</a><a class="toclink toclink-3" href="#literalconstructors">Literal Constructors</a><a class="toclink toclink-3" href="#strings">Strings</a><a class="toclink toclink-3" href="#numbers">Numbers</a><a class="toclink toclink-3" href="#operators">Operators</a><a class="toclink toclink-3" href="#coalesce">Coalesce</a><a class="toclink toclink-3" href="#existconditional">Exist Conditional</a><a class="toclink toclink-3" href="#arrays">Arrays</a><a class="toclink toclink-3" href="#slices">Slices</a><a class="toclink toclink-3" href="#typeassertion">Type Assertion</a><a class="toclink toclink-3" href="#initialization">Initialization</a><a class="toclink toclink-3" href="#superbuiltinfunction">Super (Builtin Function)</a><a class="toclink toclink-2" href="#modules">Modules</a><a class="toclink toclink-2" href="#statements">Statements</a><a class="toclink toclink-3" href="#forloop">For loop</a><a class="toclink toclink-3" href="#forin">For/In</a><a class="toclink toclink-3" href="#forinrange">For/In/Range</a><a class="toclink toclink-3" href="#ifelse">If/Else</a><a class="toclink toclink-3" href="#switchcasedefault">Switch/Case/Default</a><a class="toclink toclink-3" href="#incdec">Inc/Dec</a><a class="toclink toclink-3" href="#use">Use</a><a class="toclink toclink-3" href="#catcherror">Catch/Error</a><a class="toclink toclink-2" href="#commands">Commands</a><a class="toclink toclink-3" href="#help">Help</a><a class="toclink toclink-3" href="#run">Run</a><a class="toclink toclink-3" href="#build">Build</a><a class="toclink toclink-3" href="#compile">Compile</a><a class="toclink toclink-3" href="#http">Http</a><a class="toclink toclink-2" href="#theloader">The Loader</a><a class="toclink toclink-3" href="#configuration">Configuration</a><a class="toclink toclink-4" href="#dependenceinjection">Dependence injection</a><a class="toclink toclink-2" href="#corinthebrowser">Cor in the Browser</a><a class="toclink toclink-2" href="#thecrlcorruntimelibrary">The CRL (Cor Runtime Library)</a></p>

<h2 id="quickrecap">Quick recap</h2>

<h3 id="inlcudingmodules">Inlcuding modules</h3>

<pre><code>use '../jquery.js'
use './module'
</code></pre>

<h3 id="functions">Functions</h3>

<pre><code>// as a statement
func sum(a, b) {
    return a + b
}

// simplified statement
func sums(a, b) a + b

// as expression
mult = func(a, b) {
    return a * b
}

// simplified expression
mults = func(a, b) a * b


// module initializer
func init() {
    jquery('.panel').html(render())
}
</code></pre>

<h3 id="slicescoalesceoperatorconditionaloperator">Slices/CoalesceOperator/ConditionalOperator</h3>

<pre><code>---
Coalesce operator
---
// if `null` or `undefined` then be an empty array
panels = getPanels() ?? []

---
Slice
---
// first 5 panels
five = panels[0:5]

---
Conditional operator
---
five.forEach(func(pan) pan.maximize?())

pan.maximize?()
h = pan?.height
c = pan.children?[0]
</code></pre>

<h3 id="classes">Classes</h3>

<pre><code>---
classes are prototype based underlaying
---

class Model {
    // property with default value
    id = genId()
    conn

    // initializer
    func init() {}

    // method
    func save() {}
}
</code></pre>

<h3 id="inheritance">Inheritance</h3>

<pre><code>---
fully compatible with javascript prototypal inheritance
---
class Person : Model {
    name
    age
    func getName() me.name
    func getAge()  me.age

    // method overriding
    func save() {
        me.beforeSave()
        // super call
        super()
    }
}
</code></pre>

<h3 id="instances">Instances</h3>

<pre><code>---
use `&amp;` symbol to create instances
---

// empty object
obj = &amp;[]

// new instance
person = &amp;Person

// instance and properties setting
person = &amp;Person[
    name : 'John',
    age  : 23,
]

// positional properties setting
person = &amp;Person['John', 23]

// person.name == 'John'
// person.age == 23
</code></pre>

<h3 id="ifforswitch">If/For/Switch</h3>

<pre><code>// module initializer
func init() {
    // if
    if foo == 'bar' {
        sum()
    }

    // infinite for
    for { }

    // like `while (a) { ... }`
    for a { }

    // for-in, works for arrays and objects own properties
    for value in array { }
    for key, value in array { }

    // for-in-range
    for i in 0:10 {
        val = arr[i]
    }

    // classic for
    for i = 0; i &lt; arr.length; i++ { }

    // switch
    switch foo {
        case 1     : doOne()
        case 2     : doTwo()
        // multiple cases
        case 3,4,5 : doThreeFourFive()
        // default case
        default    : doOtherwise()
    }
}
</code></pre>

<h3 id="typeassertionerrors">TypeAssertion/Errors</h3>

<pre><code>func init() {

    // type assertion `expression.(Class/Constructor)`
    func isString(obj) {
        return obj.(String)
    }

    isPerson = obj.(Person)

    func launchError() {
        // throw an error
        error('Error launched')
    }

    ---
    catch evaluates a expression and executes a block
    of code if an error happends
    ---
    catch launchError() {
        // the builtin `error()` function returns the error object
        console.log(error())

        // also can be used to throw an error
        // it rethrows the caught error if no parametter is passed
        error()
    }

}
</code></pre>

<h2 id="semicoloninsertion">Semicolon Insertion</h2>

<p>Cor grammar uses semicolon to terminate statements, but those semicolons doesn't need to appear in the source. Instead, the lexer applies a simple rule to insert semicolons automatically as it scans, so you can avoid write it. <strong>The rule is:</strong> If the last token before a newline is an identifier (which includes keywords), a basic literal such as a number or string constant, or one of the tokens: <code>++ -- ) }</code> the lexer always inserts a semicolon after the token.</p>

<h2 id="expressions">Expressions</h2>

<h3 id="functions-1">Functions</h3>

<p>Functions may be defined using syntax such as the following:</p>

<pre><code>// as a statement
func sum(a, b) {
    return a + b
}

// as expression
mult = func(a, b) {
    return a * b
}
</code></pre>

<p>It can be used in a simplified way.</p>

<pre><code>func sums(a, b) a + b

mults = func(a, b) a * b
</code></pre>

<p>The body of the simplified way is an expression to be returned. This kind of syntax is usefull for callbacks passing, functional nuances ors compact code style.</p>

<pre><code>func init() {
    array.map(func(o) o.id).filter(func(o) o.age &gt;= 18)
}
</code></pre>

<h3 id="comments">Comments</h3>

<p>Cor supports two types of comments, one line comments, and multi-line comments. The first type starts when the lexer finds <code>//</code> and terminates in the first end of line. The second type starts once the lexer finds <code>---</code> and ends in the next occurrence of <code>---</code>. This style is also known as <code>docblock</code>.</p>

<p>Example:</p>

<pre><code>---
sum(a int, b int) int
This function returns the result of a plus b
---
func sum(a, b) {
    // sum two numbers
    return a + b
}
</code></pre>

<h3 id="variablesandlexicalscoping">Variables and Lexical Scoping</h3>

<p>Cor does not has a keyword to declare variables, instead, Cor declares it for you the first time it is used. If a variable with equal name is declared in outer scope the compiler will assume you are using the declared outside. Unless you write the variable as a simple statement. This technique is called <strong>variable announcing</strong>.</p>

<p>Example:</p>

<pre><code>outer = 'outer value'

func changeGlobal() {
    outer = 'inner value'
}

func init() {
    changeGlobal()
    console.log(outer) // 'inner value'
}
</code></pre>

<p><code>changeScope</code> function changes the value of <code>outer</code> variable defined in module scope.</p>

<pre><code>outer = 'outer value'

func changeLocal() {
    outer // force to use it as local, even if is declared in outer scope
    outer = 'inner value'
}

func init() {
    changeLocal()
    console.log(outer) // 'outer value'
}
</code></pre>

<p>In above fragment, <code>outer</code> variable will be declared in a local scope by <strong>announcing</strong> it inside <code>changeLocal</code> function.</p>

<h3 id="objects">Objects</h3>

<p>Objects are a collection of variables and functions. It may be created using <code>&amp;</code> operator.</p>

<blockquote>
  <p>In previous versions it was possible to use <code>@</code> operator, but is now deprecated.</p>
</blockquote>

<pre><code>// creates an empty object
obj = &amp;[]

// filling properties
obj.name = 'Aaron'
obj.age  = 20
</code></pre>

<p>Object properties can be assigned in more declarative way by using <code>Literal Constructors</code></p>

<pre><code>client = &amp;[
    name : 'Aaron',
    age  : 20,
    pet  : &amp;[
        name : 'Kitty',
        kind : 'Cat',
    ],
]
</code></pre>

<p>There is two ways to access object properties, by using <code>.</code> symbol or by using <code>[</code> <code>]</code> wrappers.</p>

<pre><code>client.age = 20
console.log(client.age)
// will print '20'

client['age'] = 20
console.log(client['age'])
// will print '20'
</code></pre>

<h3 id="literalconstructors">Literal Constructors</h3>

<p>A literal constructor is a list of elements bounded by <code>[</code> and <code>]</code> symbols, used for creating objects and arrays. An element can be either, expression or a key-value pair. If one element is key-value type, all other elements has to be key-value in the same declaration.</p>

<p>Example using key-value pair elements:</p>

<pre><code>walter = &amp;Client[
    name : 'Walter',
    age  : 12,
]
</code></pre>

<p>Example using expression elements:</p>

<pre><code>aaron = &amp;Client['Aaron', 20]

// aaron.name = 'Aaron'
// aaron.age  = 20
</code></pre>

<h3 id="strings">Strings</h3>

<p>A string is a series of characters delimited by <code>'</code> symbol, can be defined as following:</p>

<pre><code>aaron  = 'Aaron Swartz'
walter = 'Walter O\'Brian'

// multi-line
query = '
    SELECT
        *
    FROM Article
    WHERE slug = ?
'
</code></pre>

<h3 id="numbers">Numbers</h3>

<p>Numbers can be specified using any of the following syntaxes:</p>

<pre><code>// integer
n = 3

// signed
n = +4
n = -8

// with floating point
n = 4.7
n = +6.3
n = -50.2

// with exponential part
n = 4e12
n = 4E12
n = 3e+4
n = 3e-10
</code></pre>

<h3 id="operators">Operators</h3>

<p>Operators are the following:</p>

<pre><code>// 1 - Assignment
*=  /=  %=  +=  -=  &lt;&lt;=  &gt;&gt;=  &gt;&gt;&gt;=  &amp;=  ^=  |=

// 2 - Comparison
&lt;=  &gt;=  ==  !=  &lt;   &gt;

// 3 - Arithmetic
++  --  +   -

// 4 - Binary Bitwise
&amp;   |   ^

// 5 - Binary Logical
&amp;&amp;  ||  !

// 6 - Binary Shift
&lt;&lt;  &gt;&gt;  &gt;&gt;&gt;

// 7 - Existential
??  ?
</code></pre>

<p>The operators <code>==</code> and <code>!=</code> are translated to <code>===</code> and <code>!==</code> in the same order.</p>

<h3 id="coalesce">Coalesce</h3>

<p>The coalesce operator returns the first value that is not <code>nil</code> nor <code>undefined</code>. <code>nil</code> is returned only if all operands are <code>nil</code> or <code>undefined</code>. It replaces javascript <code>||</code> when substituting default value for <code>nil</code> or <code>undefined</code> values.</p>

<p>Examle:</p>

<pre><code>summary = article.summary ?? article.content ?? '(no content)'
</code></pre>

<p>This returns the articles's summary if exists, otherwise returns the content of the article if exists, otherwise retuns <code>(no content)</code>.</p>

<h3 id="existconditional">Exist Conditional</h3>

<p>Sometimes code tends to drown a bit in existence-checking. The exist-conditional operator lets you access members and elements only when the receiver exists, providing an empty result otherwise:</p>

<p>Example:</p>

<pre><code>someFunc?()
</code></pre>

<p>The above example should be translated to: <em>if <code>someFunc</code> exists, call it</em>. It also can be used with indexes, selectors and slices.</p>

<pre><code>len  = customers?.length;
frst = customers?[0];
copy = customers?[:];
</code></pre>

<h3 id="arrays">Arrays</h3>

<p>An array is a collection of ordered values. It may be defined using literal constructor with expressions as elements. Example:</p>

<pre><code>empty  = []
colors = ['red', 'green', 'blue']
foo    = [bar(), 56, 'baz']

// accessing
color1 = colors[0]
color2 = colors[1]

// color1 == 'red'
// color2 == 'green'
</code></pre>

<h3 id="slices">Slices</h3>

<p>Slice expression is a syntactic sugar for the javascript <code>slice</code> method, in most of the cases it constructs an array from an existing array.</p>

<pre><code>colors = ['red', 'green', 'blue']

sliced = colors[1:3] // sliced is ['green', 'blue']
sliced = colors[:1]  // sliced is ['red']
sliced = colors[1:]  // sliced is ['green', 'blue']
</code></pre>

<h3 id="typeassertion">Type Assertion</h3>

<p>Type assertions checks if a value is an instance of a class. Having the following syntax:</p>

<pre><code>value.(Class)
</code></pre>

<p>The result of type assertion evaluation is a <code>Boolean</code> value.</p>

<pre><code>obj = &amp;Object
isObject = obj.(Object) // true

class Runner {}

rnr = &amp;Runner
isRunner = rnr.(Runner) // true
isRunner = obj.(Runner) // false
</code></pre>

<h3 id="classes-1">Classes</h3>

<p>A class is a "blueprint" for objects, Cor has its own approach and keeps compatibility with javascript. Unlike javascript's <code>this</code> which references the execution scope, Cor's <code>me</code> identifier is available as a reference to the class  instance.</p>

<pre><code>class Client {
    firstName
    lastName
    accounts

    func getName() {
        return me.firstName + ' ' + me.lastName
    }
}

client           = &amp;Client
client.firstName = 'Walter'
client.lastName  = 'Martinez'

name = client.getName()
//name == Walter Martinez
</code></pre>

<p>A complex example:</p>

<pre><code>class Client {
    firstName
    lastName
    accounts
}

class Account {
    code
    ammount
}

client = &amp;Client[
    firstName : 'Aaron',
    lastName  : 20,
    accounts  : [
        &amp;Account[
            code    : '3980-121970',
            ammount : 5000,
        ],
    ],
]
</code></pre>

<p><code>me</code> keyword always references the internal scope of the class regardless its actual scope:</p>

<pre><code>class Foo {
    func bar() { }    
    func baz() {
        f = func() {
            me.bar() // call bar method of Foo class
        }
    }
}
</code></pre>

<p>In the above example <code>me</code> keyword is used inside a lambda scope, however it references the instance object of the <code>Foo</code> class.</p>

<blockquote>
  <p>The <code>this</code> keyword is intact, you can use it as in javascript, however it may lead to unsafe code, use <code>this</code> at your own risk.</p>
</blockquote>

<h3 id="initialization">Initialization</h3>

<p>There is two ways to define class initialization. The first way is by declaring a property-set before any method declaration:</p>

<pre><code>class Animal {
    name
    movement

    // methods...
}


// a = &amp;Animal['snake', 'slithering']
// a = &amp;Animal[
//      name:     'snake',
//      movement: 'slithering',
//  ]
</code></pre>

<p>The second one is by declaring <code>init</code> as the first member of the class. You should use this way case of inheriting from a class defined in a javascript library which relays in <code>constructor</code> e.g: views and models of Backbone.js. Using this approach does not mean there is a <code>init</code> method in the compiled <code>js</code>, it will be translated to <code>constructor</code>, so that if you use <code>super</code> builtin function, it will call the constructor of the super class, see <a href="#superbuiltinfunction">Super (Builtin Function)</a>.</p>

<p>Example:</p>

<pre><code>class Animal : Model {
    func init(name, movement) {
        me.name     = name
        me.movement = movement
        super()
    }

    // methods...
}

// a = &amp;Animal['snake', 'slithering']
</code></pre>

<blockquote>
  <p>You can use eiter, <code>init</code> method or property-set, but not both.</p>
</blockquote>

<h3 id="inheritance-1">Inheritance</h3>

<p>Cor supports single inheritance by using <code>:</code> operator. It embraces javascript prototype chain, so it is safe to use it along with any javascript libraries.</p>

<p>Example:</p>

<pre><code>class Shape {
    func getArea() {
        //...
    }
}

class Triangle : Shape {
    func getArea() {
        //custom area
    }
}
</code></pre>

<p>In above example <code>Triangle</code> class inherits from <code>Shape</code> class.</p>

<h3 id="superbuiltinfunction">Super (Builtin Function)</h3>

<p>The <code>super</code> builtin function calls a method of the super class. It will call the method with equal name to the current method where <code>super</code> is located. It should compile to <code>&lt;SuperClass&gt;.prototype.&lt;Method&gt;.apply(this, arguments)</code></p>

<p>Example:</p>

<pre><code>class Employee {
    func getSalary() {
        return 3000
    }
}

class Chairman : Employee {
    func getSalary() {        
        return super()*2
    }
}
</code></pre>

<p>Calling <code>super</code> with parameters:</p>

<pre><code>class Window {
    func show(position) {
        me.renderTo(position)
    }
}

class DialogBox : Window {
    func show() {
        super('center')
    }
}
</code></pre>

<h2 id="modules">Modules</h2>

<p>A module is a <code>.cor</code> file containing definitions and declarations that can be used by other modules. Variables, classes and functions defined in a module are all exported without needing a keyword or a special statement. The name of the file is the name of the module with <code>.cor</code> suffix.</p>

<p>Cor modules are <code>CommonJS</code> compliant, so it is possible to use Cor modules from javascript and vice versa, whenever it implements <code>CommonJS</code> specifications.</p>

<p>Example:</p>

<pre><code>// math.cor

PI = 3.141592

func circleArea(r) {
    return r * r * PI
}

class Circle {
    radius
    func area() {
        return circleArea(me.radius)
    }
}
</code></pre>

<p>This module exports <code>PI</code> variable, <code>circleArea</code> function and <code>Circle</code> class. Once a module is required, it initializes by executing(if exists) a function named <code>init</code>. Modules initializes the first time is required.</p>

<p>Example:</p>

<pre><code>http = nil

func init() {
    http = &amp;HttpServer
}
</code></pre>

<p>Once this module is initialized, <code>http</code> variable will have an instance of <code>HttpServer</code> class.</p>

<blockquote>
  <p>A module may only contain variable declarations, functions, classes, and <code>use</code> statements.</p>
</blockquote>

<p>Modules which the first letter of its name is uppercased only exports the construction (variable, class or function) which has the name equal to the module name. This convention replaces <code>CommonJS</code> <code>module.exports</code> however is completely compatible whith it.</p>

<p>Example:</p>

<p>Let's suppose we have the following project structure:</p>

<pre><code>app
  |── app.cor
  └── model
        └── User.cor
</code></pre>

<p>In <code>model/User.cor</code></p>

<pre><code>class User {
    username
    password    
}
</code></pre>

<p>There is a class named equal to the <code>filename</code>, so it will be exported by default. Any other function or variable defined in the module wil not be exported.</p>

<p>In <code>app.cor</code></p>

<pre><code>use 'model/User'

func init() {
    u = &amp;User['ragnar', 'secretpass']
}
</code></pre>

<p>Don't need to qualify the name when importing throwgh <code>use</code> statement because the class <code>User</code> will be exported as default.</p>

<h2 id="statements">Statements</h2>

<h3 id="forloop">For loop</h3>

<p>For loops similar to javascript For statement, but with higher flexibility. It has two syntaxes, the first is:</p>

<pre><code>for Start; Continuation; Statement {
    Statements
}
</code></pre>

<p>Example:</p>

<pre><code>fruits = ['orange', 'apple', 'pear']

for i = 0, len = fruits.length; i &lt; len; i++ {
    console.log(fruits[i])
}

// orange
// apple
// pear
</code></pre>

<p>Each one of these expressions can be empty.</p>

<pre><code>// infinite loop
for ;; {

}

// whith only ContinuationExpression
for ; i == len; i ++ {

}
</code></pre>

<p>The second syntax is more compact than previous, it replaces <code>while</code> statements founded in many programming languages. The syntax is:</p>

<pre><code>for Condition {
    Statements
}
</code></pre>

<p>Example:</p>

<pre><code>// executes while i is less than 10
for i &lt; 10 {
    i++
}

// executes while cm is truthy
for cm = comments.next() {
    cm.show()
}

// infinite loop
for {

}
</code></pre>

<p>If you need to jump to the next iteration or to get out of the current curl, <code>break</code> and <code>continue</code> are there for you, it behaves exactly as in javascript.</p>

<pre><code>array = [4, 3, 'Cor', 'PHP', 5, 'Go', 1, 7, 'Python']
langs = []

for item = array.shift() {
    if item.(Number) { continue }
    langs.push(item)
}
</code></pre>

<h3 id="forin">For/In</h3>

<p>A for/in loop provides the easiest way to iterate collections. There are two syntaxes; the second one is a slight extension of the first.</p>

<p>The first syntax gives access to the current value in each iteration.</p>

<pre><code>arr = [1, 2, 3]
sum   = 0

for value in arr {
    sum += value
}

// sum == 6
</code></pre>

<p>The second way is similar but exposes the current index and value in each iteration.</p>

<pre><code>arr = ['Jeremy', 'Nolan', 'Brendan']

for index, value in arr {
    console.log(index + ' ' + value)
}

// 0 Jeremy
// 1 Nolan
// 2 Brendan
</code></pre>

<p>For-In can be used to iterate over object properties</p>

<pre><code>obj = &amp;[name: 'Bill', age: 50]

for index, value in obj {
    console.log(index + ' ' + value)
}

// name Bill
// age 50
</code></pre>

<blockquote>
  <p>For-In statements iterates through the object own prototype.</p>
</blockquote>

<h3 id="forinrange">For/In/Range</h3>

<p>The For/in/range flavor is a convenient syntanctic sugar that regards most of the iteration use cases.</p>

<pre><code>for i in [0:100] {
    // ...
}

// is the same to
for i = 0; i &lt; 100 ;i++ {

}
</code></pre>

<h3 id="ifelse">If/Else</h3>

<p><code>if</code> statement is one of the most important features in many languages including Cor. It allows the execution of conditional code fragments.</p>

<p>Example:</p>

<pre><code>// if-else
if a &lt; b {

} else {

}

// with else-if
if a &lt; b {

} else if b == 0 {

}
</code></pre>

<h3 id="switchcasedefault">Switch/Case/Default</h3>

<p>With Cor you don't need to remember to <code>break</code> after every <code>case</code>. Cor switch statements prevents accidental fall-though by automatically breaking at the end of each <code>case</code> clause.</p>

<p>Switch statements in Cor can take multiple values for each <code>case</code> clause. If any of the values match, the clause runs.</p>

<pre><code>switch good {
    case 'House' : fee = 50
    case 'Boat'  : fee = 20
    case 'Car'   : fee = 10
    default      :
        fee = 0
        console.log('The citizen has no House, Boat, or Car')
}

// with multiple values in a single case clause
switch num {
    case 0, 1 : alert('0 or 1')
    case 2, 3 : alert('2 or 3')
}
</code></pre>

<h3 id="incdec">Inc/Dec</h3>

<p>Inc/Dec statement increments or decrements an expression. Similar features are found in many languages but these are offered as an expression, in Cor it is a statement.</p>

<p>Example:</p>

<pre><code>// correct usage
func init() {
    a = 0
    a++
    a--
}
</code></pre>

<p>The grammar enforces to be used as a statement.</p>

<pre><code>// will cause a parsing error
// because it is used as an expression
b = a++
</code></pre>

<h3 id="use">Use</h3>

<p>Use statement imports modules previously defined. The <code>use</code> keyword behaves ruled by some conventions.</p>

<p>Example:</p>

<pre><code>// importing math.cor
use './math'

func init() {
    console.log(math.PI)
}
// 3.141592
</code></pre>

<p>Aliases can be used for abbreviation or to avoid name collisions inside module scope</p>

<pre><code>use './finance' fnc

func init() {
    m = fnc.newMortgage(352000)
}
</code></pre>

<p>You may see <a href="#modules">Modules</a> and <a href="#configuration">Configuration</a> as a complement.</p>

<h3 id="catcherror">Catch/Error</h3>

<p>Cor has a simple exception model that works very well with javascript exceptions, it guarantees full interoperability between both languages. The <code>catch</code> statement executes a defined block of instructions if a exception is thrown by a watched expression.</p>

<pre><code>catch WatchedExpression {
    // ... instructions
}
</code></pre>

<p>Example:</p>

<pre><code>catch someFunc() {
    console.log(error())
}
</code></pre>

<p>if <code>error()</code> builtin function is used as a value it will return the thrown error. It should throw otherwise.</p>

<p>Example:</p>

<pre><code>catch someFunc() {
    // throw catched error
    error()

    // throw custom error
    error(&amp;TypeError)
}
</code></pre>

<h2 id="commands">Commands</h2>

<p>Cor cli is available as a <a href="http://nodejs.org">Node.js</a> utility, it allows you to compile and build sources. Commands are used as subcommands of Cor program, for instance <code>cor build</code>. Each command may have parameters and options, parameters are passed after the name of the command and options are specified using the following format: <code>-option=value</code> which must be specified after parameters. To know about usage, <code>help</code> command is there for you. Running <code>cor help</code> or just <code>cor</code> would show available commands, and <code>cor help [command]</code> will print usage of the specified <code>command</code>.</p>

<h3 id="help">Help</h3>

<p><code>help</code> command prints documentation about available commands. Is a tool to guide <code>cor</code> cli usage without to get out of the console.</p>

<p>Usage:</p>

<pre><code>cor help [command]
</code></pre>

<p>Will shows available commands. Also prints usage and documentation about a specified command.</p>

<p>Example:</p>

<pre><code>cor help build
</code></pre>

<p>Prints documentation about <code>cor build</code> command</p>

<pre><code>cor help compile
</code></pre>

<p>Prints documentation about <code>cor compile</code> command</p>

<h3 id="run">Run</h3>

<p><code>run</code> command reads and executes a <code>.cor</code> file containing Cor source code.</p>

<p>Usage:</p>

<pre><code>cor run &lt;path&gt; [run options]
</code></pre>

<table>
    <tbody>
        <tr><td colspan="2">Arguments:</td></tr>
        <tr>
            <td class="cmd-arg"><code>path</code></td>
            <td>Specifies the path to the file to execute.</td>
        </tr>
        <tr><td colspan="2">Options:</td></tr>
        <tr>
            <td class="cmd-arg"><code>-conf</code></td>
            <td>Specifies the path to the <code>.json</code> file to use as configuration.</td>
        </tr>
    </tbody>
</table>

<p>Example:</p>

<pre><code>cor run path/to/file.cor
</code></pre>

<p>Runs a program located in the specified path.</p>

<h3 id="build">Build</h3>

<p><code>build</code> command compiles <code>.cor</code> files and its dependencies, the resulting javascript code will be packed and written to a standalone <code>.js</code>. The CRL will be embedded in the head of the resulting file unless you use <code>-no-crl</code> oprtion. The <code>build</code> command supports four types of packages: AMD, CommonJS, Global and DOM Ready.</p>

<p>Usage:</p>

<pre><code>cor build &lt;path&gt; [build options]
</code></pre>

<table>
    <tbody>
        <tr><td colspan="2">Arguments:</td></tr>
        <tr>
            <td class="cmd-arg"><code>path</code></td>
            <td>Specifies the path to the entry file to build.</td>
        </tr>
        <tr><td colspan="2">Options:</td></tr>
        <tr>
            <td class="cmd-arg"><code>-o</code></td>
            <td>Specifies the name of the file where the resulting javascript code will be written, if not specified the file name will be the base name of the entry file with <code>.js</code> suffix.</td>
        </tr>
        <tr>
            <td class="cmd-arg"><code>-conf</code></td>
            <td>Specifies the path to the <code>.json</code> file to use as configuration.</td>
        </tr>
        <tr>
            <td class="cmd-arg"><code>-type</code></td>
            <td>Specifies the type of the resulting bundle. The supported types are <code>domready</code>, <code>commonjs</code>, <code>amd</code> and <code>global</code>. It must be provided separated by <code>,</code>(<i>do not write spaces between</i>). <code>domready</code> type will be used by default if <code>-type</code> option is omitted.</td>
        </tr>
        <tr>
            <td class="cmd-arg"><code>-no-crl</code></td>
            <td>If used will not embed CRL(Cor Runtime Library) in the head of the compiling result.</td>
        </tr>
        <tr>
            <td class="cmd-arg"><code>-v</code></td>
            <td>If used will print additional information during building process.</td>
        </tr>
    </tbody>
</table>

<p>Example:</p>

<pre><code>cor build myapp.cor
</code></pre>

<p>Builds <code>myapp</code> program and its dependencies and creates a file named <code>myapp.cor.js</code> inside <code>myapp</code> directory containing the resulting javascript code.</p>

<pre><code>cor build myapp.cor -crl -o=app.js
</code></pre>

<p>In this case the output file is named <code>app.js</code> and CRL will be embedded in the beginning of the file.</p>

<pre><code>cor build myapp -env=myapp/env.json
</code></pre>

<p>Builds <code>myapp.cor</code> program and tells compiler the environment file is located at <code>myapp/env.json</code>.</p>

<pre><code>cor build ./mylib.cor -type=amd,commonjs,global
</code></pre>

<p>Build <code>./mylib.cor</code> file making it available through AMD, CommonJS and Global api.</p>

<h3 id="compile">Compile</h3>

<p><code>compile</code> command compiles source contained in a directory and put the result in the specified output directory. Every file contained in the source dir will be copied to the destination preserving the original directory structure as they are, except <code>.cor</code> or any other file processed by the loader. These files will be compiled and written to the file system as <code>.js</code>.</p>

<p>Usage:</p>

<pre><code>cor compile &lt;path&gt; [compile options]
</code></pre>

<table>
    <tbody>
        <tr><td colspan="2">Arguments:</td></tr>
        <tr>
            <td class="cmd-arg"><code>path</code></td>
            <td>Specifies the path to the directory which contains files to compile.</td>
        </tr>
        <tr><td colspan="2">Options:</td></tr>
        <tr>
            <td class="cmd-arg"><code>-o</code></td>
            <td>Specifies the path to the directory where the compiled files will be written. The default name has the format: <code>compiled_{timestamp}<code></td>
        </tr>
        <tr>
            <td class="cmd-arg"><code>-v</code></td>
            <td>Specifies whether to print or not file names as they are compiled.</td>
        </tr>
    </tbody>
</table>

<p>Example:</p>

<pre><code>cor compile ./mylib
</code></pre>

<p>Compiles source inside <code>mylib</code> directory and creates a directory named <code>mylib_js_</code> followed by a timestamp, here is where the compiled content will be written.</p>

<pre><code>cor compile mylib -o=../delivery_dir/mylib
</code></pre>

<p>In this case the output directory is <code>../delivery_dir/mylib</code></p>

<h3 id="http">Http</h3>

<p><code>http</code> command launch a simple http server using current directory (<code>cwd</code>) as the root. If a directory is requested it will list all files inside as a list of html links (<code>&lt;a href=""&gt;&lt;/a&gt;</code>). This server is for development purpose; do not use it in production.</p>

<p>Usage:</p>

<pre><code>cor http [http options]
</code></pre>

<table class="command-args">
    <tbody>
        <tr><td colspan="2">Options:</td></tr>
        <tr>
            <td class="cmd-arg"><code>-port</code></td>
            <td>Specifies the port where the server will listen requests. Default is <code>9000</code></td>
        </tr>
    </tbody>
</table>

<p>Example:</p>

<pre><code>cor http
</code></pre>

<p>Launch an http server using <code>9000</code> port.</p>

<pre><code>cor http -port=8790
</code></pre>

<p>Using <code>8790</code> port.</p>

<h2 id="theloader">The Loader</h2>

<p>The loader is a component which manages dependencies and dynamically loads files into the browser by using Ajax and using <code>fs</code> library on Node.js. It is extensible, so, it is possible to add support for any processor, for example, Markdown, or Mustache. It expects every requested file to be <code>CommonJS</code> compliant. It is intended to be used just for development, so, once the cource is compiled and packed the loader is not needed any more.</p>

<p>The loader supports <code>.js</code> files loading out of the box, hence it is possible to use thirth party javascript libraries compliant with <code>CommonJS</code> specifications.</p>

<p>This is a valid Cor project:</p>

<pre><code>// filename: app.cor

use './jquery.js'   jquery
use './template.js' tpl

func show() {
    jquery.get('http://server.com/api.php', func(r) tpl.render(r))
}

func init() {
    show()
}
</code></pre>

<h3 id="configuration">Configuration</h3>

<p>The configuration file must be in JSON format, but not javascript object literal, it will affect the behavior of the loader beeing used to resolve dependencies. This file should be named <code>conf.json</code> just for convention, however you can choose de name you prefer. It must be used with <code>-conf</code> option in <code>cor build</code> command or with <code>data-conf</code> in HTML pages. All relative paths defined are relative to the configuration file. The file might look like this:</p>

<pre><code>{    
    "paths" : {
        "jquery"     : "node_modules/jquery/dist/jquery.js",
        "underscore" : "node_modules/underscore/underscore.js",
        "backbone"   : "node_modules/backbone/backbone.js"
    },

    "ignore"         : ["fs", "child_process"]
}
</code></pre>

<p>Values:</p>

<ul>
<li><p><strong>paths</strong>: The mapping from routes (used with <code>use</code> statement in Cor or with <code>require</code> function in javascript) to file paths.</p></li>

<li><p><strong>ignore</strong>: The routes to be ignored.</p></li>
</ul>

<p>With the above example we could write:</p>

<pre><code>// Backbone.js requires jQuery and Underescore.js
// the loader will handle it

use 'backbone' bbone

class TodoModel : bbone.Model {
    // ...
}
</code></pre>

<h4 id="dependenceinjection">Dependence injection</h4>

<p>If you have not catched on, the configuration file is good resource for dependence injection. Check the following configuration:</p>

<pre><code>{

    "paths" : {
        "jquery" : "node_modules/zepto/zepto.js"
    }
}
</code></pre>

<p>In the above case we inject Zepto.js to be used used as <code>jquery</code> replacement under the same route.</p>

<h2 id="corinthebrowser">Cor in the Browser</h2>

<p>Cor library (located at <code>cor/dist/cor.js</code>) should be inlcuded using a script <code>tag</code> inside a html page for development environments:</p>

<pre><code>&lt;html&gt;
    &lt;script type="text/javascript" src="cor/dist/cor.js"&gt;&lt;/script&gt;
&lt;/html&gt;
</code></pre>

<p>Once the DOM is ready the Loader will look for a script tag containig the <code>data-entry</code> or <code>data-conf</code> attribute, or both to boot the application. Example:</p>

<pre><code>&lt;script data-entry="myapp.cor"&gt;&lt;/script&gt;
</code></pre>

<p>In the above example was setted <code>myapp.cor</code> module as the entry of  the application.</p>

<p>Example using a <code>.js</code> module as entry:</p>

<pre><code>&lt;script data-entry="./myapp.js" data-conf="./conf.json"&gt;&lt;/script&gt;
</code></pre>

<p>The Cor distribution for browsers is recomended only for development purpose, to take advantage of the hot-realod avoiding the <em>compile</em> step in the <em>coding/compile/run/test</em> worflow. However you must use the <code>build</code> command before to put an application in production, example: <code>cor build ./myapp.cor -conf=./conf.json</code> and utilize the resulting standalone <code>.js</code> file which will contain all the application and its dependences.</p>

<h2 id="thecrlcorruntimelibrary">The CRL (Cor Runtime Library)</h2>

<p>The CRL is a small (~3Kb) library which makes possible to take advantage of features such as <em>for/in statements, inheritance, type assertions, among others</em>. Without the CRL, the javascript code obtained as the result of compilation could be repetitive and bigger in consequence, that's one of the reasons that CRL exits, to provide a small set of features that will be internally used by the javascript resulting code.</p>        <div class="full-rule"></div>

        <div class="feature footer-links">
            <ul>
                <li><a href="https://github.com/yosbelms/cor">GitHub Repository</a></li>
                <li>&middot;</li>
                <li><a href="http://ost.io/@yosbelms/cor">Discussions</a></li>
                <li>&middot;</li>
                <li><a href="http://github.com/yosbelms/cor/issues">Issues</a></li>
                <li>&middot;</li>
                <li><a href="http://github.com/yosbelms/cor/contributors">Contributors</a></li>
            </ul>
        </div>

    </div>

    <div class="feature footer">
            <p>Designed, written, and built with love by <a href="https://github.com/yosbelms" target="_blank">Yosbel Marín</a>. Code licensed under <a href="https://github.com/yosbelms/cor/blob/master/LICENSE" target="_blank">BSD</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
    </div>

    <script type="text/javascript" src="assets/highlightjs/highlight.js"></script>
    <script type="text/javascript"> hljs.initHighlightingOnLoad(); </script>

    <!--start clicky stub-->
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-73271106-1', 'auto');
      ga('send', 'pageview');

    </script>
        
    <!--end of clicky stub-->
    
    </body>
</html>
